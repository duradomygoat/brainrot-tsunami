<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Escape A Tsunami: Brainrot Edition</title>
<style>
body { margin:0; overflow:hidden; font-family:Arial; }
#ui { position:absolute; top:10px; left:10px; color:white; text-shadow:2px 2px 6px black; font-size:14px; }
#gameOver { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:50px; color:red; text-shadow:3px 3px 8px black; display:none; }
</style>
</head>
<body>
<div id="ui">
Money: ðŸ’° <span id="money">0</span><br>
Banked Brainrots: ðŸ§  <span id="bank">0</span>
</div>
<div id="gameOver">THE TSUNAMI GOT YOU ðŸŒŠ</div>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87CEEB);

const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 5000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.6));
const sun = new THREE.DirectionalLight(0xffffff,1);
sun.position.set(200,300,100);
sun.castShadow = true;
scene.add(sun);

// Ground
const ground = new THREE.Mesh(
 new THREE.PlaneGeometry(2000,5000),
 new THREE.MeshStandardMaterial({color:0x3cb043})
);
ground.rotation.x = -Math.PI/2;
scene.add(ground);

// Player
const player = new THREE.Group();
function part(w,h,d,color,x,y,z){
 const m = new THREE.Mesh(new THREE.BoxGeometry(w,h,d), new THREE.MeshStandardMaterial({color}));
 m.position.set(x,y,z);
 return m;
}
player.add(
 part(2,3,1.5,0x1565C0,0,3,0),
 part(1.8,1.8,1.8,0xffcc99,0,5,0),
 part(0.9,2.5,0.9,0x222222,-0.6,1.2,0),
 part(0.9,2.5,0.9,0x222222,0.6,1.2,0)
);
scene.add(player);

// ===== Detailed Brainrot Model =====
function createBrainrot(){
 const group = new THREE.Group();

 const core = new THREE.Mesh(
  new THREE.SphereGeometry(1.5,32,32),
  new THREE.MeshStandardMaterial({color:0xaa00ff, emissive:0x5500aa, roughness:0.3, metalness:0.6})
 );
 group.add(core);

 // Spikes
 for(let i=0;i<20;i++){
  const spike = new THREE.Mesh(
   new THREE.ConeGeometry(0.3,1,8),
   new THREE.MeshStandardMaterial({color:0xff00ff})
  );
  spike.position.set(
    (Math.random()-0.5)*3,
    (Math.random()-0.5)*3,
    (Math.random()-0.5)*3
  );
  spike.lookAt(0,0,0);
  group.add(spike);
 }

 return group;
}

const collectibles=[];
let carried=0;
let banked=0;
let money=0;

function spawnBrainrot(x,z){
 const mesh = createBrainrot();
 mesh.position.set(x,3,z);
 scene.add(mesh);
 collectibles.push(mesh);
}
for(let i=0;i<80;i++) spawnBrainrot((Math.random()-0.5)*200,-i*80-200);

// Wave
const wave = new THREE.Mesh(
 new THREE.PlaneGeometry(1000,200,100,30),
 new THREE.MeshStandardMaterial({color:0x1e90ff, transparent:true, opacity:0.9, side:THREE.DoubleSide})
);
wave.position.set(0,100,-300);
scene.add(wave);

// ===== Right Click Camera Look =====
let yaw = 0;
let pitch = 0;
let rightClick = false;

document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('mousedown', e => {
 if(e.button === 2) rightClick = true;
});
document.addEventListener('mouseup', e => {
 if(e.button === 2) rightClick = false;
});
document.addEventListener('mousemove', e => {
 if(rightClick){
   yaw -= e.movementX * 0.002;
   pitch -= e.movementY * 0.002;
   pitch = Math.max(-Math.PI/3, Math.min(Math.PI/3, pitch));
 }
});

camera.position.set(0,8,20);
let speed=0.4;
let velocityY=0;
let onGround=true;
let gameOver=false;
const keys={};
document.addEventListener('keydown',e=>keys[e.key.toLowerCase()]=true);
document.addEventListener('keyup',e=>keys[e.key.toLowerCase()]=false);

function animate(){
 if(gameOver) return;
 requestAnimationFrame(animate);

 speed+=0.00005;
 const moveSpeed=speed;

 const forward = new THREE.Vector3(Math.sin(yaw),0,Math.cos(yaw));
 const right = new THREE.Vector3(forward.z,0,-forward.x);

 if(keys['w']) player.position.addScaledVector(forward,-moveSpeed);
 if(keys['s']) player.position.addScaledVector(forward,moveSpeed);
 if(keys['a']) player.position.addScaledVector(right,-moveSpeed);
 if(keys['d']) player.position.addScaledVector(right,moveSpeed);

 if(keys[' ']&&onGround){ velocityY=0.9; onGround=false; }
 velocityY-=0.05;
 player.position.y+=velocityY;
 if(player.position.y<=0){ player.position.y=0; velocityY=0; onGround=true; }

 // Collect
 collectibles.forEach(c=>{
  c.rotation.y+=0.02;
  c.rotation.x+=0.01;
  if(c.visible && player.position.distanceTo(c.position)<3){
    c.visible=false;
    carried++;
  }
 });

 // Deposit at origin base zone
 if(player.position.length()<30 && carried>0){
  banked+=carried;
  money+=carried*10;
  carried=0;
 }

 // Wave motion
 const pos = wave.geometry.attributes.position;
 for(let i=0;i<pos.count;i++){
  pos.setZ(i, Math.sin(i*0.2 + Date.now()*0.003)*6);
 }
 pos.needsUpdate=true;
 wave.position.z+=speed*0.9;

 if(wave.position.z+50>player.position.z){
  document.getElementById('gameOver').style.display='block';
  gameOver=true;
 }

 // Camera follow
 const cameraOffset = new THREE.Vector3(0,8,20);
 cameraOffset.applyAxisAngle(new THREE.Vector3(0,1,0), yaw);
 camera.position.copy(player.position).add(cameraOffset);
 camera.lookAt(player.position.x, player.position.y+5, player.position.z);

 document.getElementById('money').innerText=money;
 document.getElementById('bank').innerText=banked;

 renderer.render(scene,camera);
}
animate();

window.addEventListener('resize',()=>{
 camera.aspect=window.innerWidth/window.innerHeight;
 camera.updateProjectionMatrix();
 renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>
